logs:
  configs:
  - name: docker-logs
    clients:
      - url: http://loki:3100/loki/api/v1/push
    positions:
      filename: /tmp/positions.yaml
    scrape_configs:
      - job_name: docker
        docker_sd_configs:
          - host: unix:///var/run/docker.sock
        pipeline_stages:
          - regex:
              # формат: 2025-09-07 10:00:00 INFO
              expression: '.*\s(?P<level>DEBUG|INFO|WARN|ERROR|TRACE|FATAL)\s.*'
          - regex:
              # формат: [INFO] что-то там
              expression: '.*\[(?P<level>DEBUG|INFO|WARN|ERROR|TRACE|FATAL)\].*'
          - regex:
              # формат: level=INFO
              expression: '.*level=(?P<level>DEBUG|INFO|WARN|ERROR|TRACE|FATAL).*'
          - labels:
              level:
        relabel_configs:
          - source_labels: [__meta_docker_container_name]
            target_label: container
          - source_labels: [__meta_docker_container_image]
            target_label: image

